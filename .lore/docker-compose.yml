# Lore runtime â€” docs UI + semantic search + maintenance watcher.
# Pulls the published image. Run with: docker compose -f .lore/docker-compose.yml up -d
# LORE_DOCS_PORT and LORE_SEMANTIC_PORT set by /lore-docker for multi-instance support.
# COMPOSE_PROJECT_NAME set by /lore-docker to basename of project root (e.g. my-project).
name: ${COMPOSE_PROJECT_NAME:-lore}
services:
  lore-runtime:
    image: lorehq/lore-docker:latest
    ports:
      - '${LORE_DOCS_PORT:-9184}:8000'
      - '${LORE_SEMANTIC_PORT:-9185}:8080'
    environment:
      - DEFAULT_K=${SEMANTIC_DEFAULT_K:-8}
      - MAX_K=${SEMANTIC_MAX_K:-20}
      - MAX_CHUNK_CHARS=${SEMANTIC_MAX_CHUNK_CHARS:-1000}
      - SNIPPET_CHARS=${SEMANTIC_SNIPPET_CHARS:-200}
      - RESULT_MODE=${SEMANTIC_RESULT_MODE:-paths_min}
      - EMBED_MODEL=${SEMANTIC_EMBED_MODEL:-BAAI/bge-small-en-v1.5}
    volumes:
      - ../docs:/data/docs
      - ../.lore/skills:/data/skills:ro
      - runtime_data:/runtime-data
      - runtime_cache:/runtime-cache
    restart: unless-stopped

volumes:
  runtime_data:
  runtime_cache:
